<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.122.0"><meta name=description content><link rel=icon href=/images/favicon.png type=image/png><title>Inspecting clients :: Velociraptor - Digging deeper!</title>
<link href=/css/nucleus.css?1728917965 rel=stylesheet><link href=/css/fontawesome-all.min.css?1728917965 rel=stylesheet><link href=/css/featherlight.min.css?1728917965 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1728917965 rel=stylesheet><link href=/css/auto-complete.css?1728917965 rel=stylesheet><link href=/css/theme.css?1728917965 rel=stylesheet><link href=/css/tabs.css?1728917965 rel=stylesheet><link href=/css/hugo-theme.css?1728917965 rel=stylesheet><link href=/css/theme-mine.css?1728917965 rel=stylesheet><link href=/css/dark.css?1728917965 rel=stylesheet><link href=/css/syntax.css?1728917965 rel=stylesheet><link href=/css/light.css?1728917965 rel=stylesheet><link href=/css/hljs.css?1728917965 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1728917965 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1728917965></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-QYH72LMYCS"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QYH72LMYCS",{anonymize_ip:!1})}</script><script>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-QYH72LMYCS","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script><script></script></head><body data-url=/docs/gui/clients/><nav id=sidebar><div id=header-wrapper><div id=header><script>function darkmode(){$("body").addClass("dark").removeClass("light"),document.cookie="theme=darkmode;path=/"}function lightmode(){$("body").removeClass("dark").addClass("light"),document.cookie="theme=lightmode;path=/"}const regex=new RegExp("theme=darkmode");regex.test(document.cookie)?darkmode():lightmode()</script><div class="btn btn-default ThemeSelector darkmode" onclick=darkmode()><i class="fas fa-moon"></i></div><div class="btn btn-default ThemeSelector lightmode" onclick=lightmode()><i class="fas fa-sun"></i></div><a href=https://docs.velociraptor.app/><img src=https://docs.velociraptor.app//images/logo.svg></a></div></div><div class=highlightable><ul class=topics><li data-nav-id=https://docs.velociraptor.app/announcements/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/announcements/><i class="fas fa-bullhorn"></i>Announcements</a></div><ul><li data-nav-id=https://docs.velociraptor.app/announcements/2023-cves/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/2023-cves/>Current CVEs</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/ class="dd-item parent haschildren"><div><i class="fa fa-angle-down fa-sm category-icon"></i>
<a href=/docs/><i class="fas fa-book-reader"></i>Documentation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/overview/>Velociraptor Overview</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/history/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/history/>History</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/overview/support/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/support/>Support Policy</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/>Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/self-signed/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/self-signed/>Self-Signed SSL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/>Cloud Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/multifrontend/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/multifrontend/>Multi-Frontend</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/orgs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/orgs/>Organizations</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/clients/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/clients/>Deploying Clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/security/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/security/>Security</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/resources/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/resources/>Performance</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/troubleshooting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/troubleshooting/>Troubleshooting</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/references/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/references/>Config Reference</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/ class="dd-item parent haschildren"><div><i class="fa fa-angle-down fa-sm category-icon"></i>
<a href=/docs/gui/>The Admin GUI</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/gui/clients/ class="dd-item active"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/clients/>Inspecting clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/vfs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/vfs/>The VFS</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/artifacts/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/artifacts/>Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/hunting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/hunting/>Hunting</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/vql/>VQL Fundamentals</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/vql/notebooks/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/notebooks/>Notebooks</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/artifacts/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/artifacts/>Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/join/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/join/>JOIN in VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/events/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/events/>Event Queries</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/forensic/>Forensic Analysis</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/>Searching Filenames</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/paths/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/paths/>Velociraptor Paths</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/remapping/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/remapping/>Remapping Accessors</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/searching/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/searching/>Searching Content</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ntfs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/ntfs/>NTFS Analysis</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/binary/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/binary/>Binary parsing</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/evidence_of_execution/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/evidence_of_execution/>Evidence Of Execution</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/event_logs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/event_logs/>Event Logs</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/volatile/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/volatile/>Volatile State</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/offline_triage/>Triage and acquisition</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/remote_uploads/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/offline_triage/remote_uploads/>Remote Uploads</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/client_monitoring/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/client_monitoring/>Client Monitoring</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/extending_vql/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/extending_vql/>Extending VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/server_automation/>Server Automation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_api/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_api/>Server API</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_monitoring/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_monitoring/>Server Monitoring</a></div></li></ul></li></ul></li><li data-nav-id=https://docs.velociraptor.app/downloads/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/downloads/><i class="fas fa-download"></i>Downloads</a></div></li><hr><li data-nav-id=https://docs.velociraptor.app/vql_reference/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/vql_reference/><i class="fas fa-book"></i>VQL Reference</a></div><ul><li data-nav-id=https://docs.velociraptor.app/vql_reference/basic/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/basic/>Basic VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/linux/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/linux/>Linux Specific</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/windows/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/windows/>Windows Specific</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/parsers/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/parsers/>Parsers</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/server/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/server/>Server Side</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/plugin/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/plugin/>Client Side</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/event/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/event/>Event Plugins</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/experimental/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/experimental/>Experimental</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/misc/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/misc/>Misc</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/accessors/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/accessors/>Accessors</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/training/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/training/><i class="fas fa-graduation-cap"></i>Training</a></div><ul><li data-nav-id=https://docs.velociraptor.app/training/playbooks/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/training/playbooks/><i class="fas fa-play"></i>Playbooks</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/blog/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/blog/><i class="fas fa-newspaper"></i>Blog</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/presentations/><i class="fas fa-chalkboard-teacher"></i>Presentations</a></div><ul><li data-nav-id=https://docs.velociraptor.app/presentations/2022_linuxconf_au/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_linuxconf_au/>Linux Conf Au 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_auscert/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_auscert/>Auscert 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_sans_summit/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_sans_summit/>SANS Summit 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_velocon/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_velocon/>Velocon 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_dfrws_apac/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_dfrws_apac/>DFRWS APAC 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2023_everything_open/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2023_everything_open/>EverythingOpen 2023</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2023_velocon/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2023_velocon/>VeloCON 2023</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2024_auscert/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2024_auscert/>Auscert 2024</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2024_auscert-detection-engineering/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2024_auscert-detection-engineering/>Auscert 2024 Talk</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/exchange/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/exchange/><i class="fas fa-code"></i>Artifact Exchange</a></div></li><li data-nav-id=https://docs.velociraptor.app/artifact_references/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/artifact_references/><i class="fas fa-book"></i>Artifact Reference</a></div></li><li data-nav-id=https://docs.velociraptor.app/knowledge_base/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/knowledge_base/><i class="fas fa-brain"></i>Knowledge Base</a></div></li><li data-nav-id=https://docs.velociraptor.app/search/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/search/><i class='fas fa-search'></i>Search</a></div></li></ul><hr><section id=shortcuts><h3></h3><ul><li><a class=padding href=https://github.com/Velocidex/velociraptor><i class='fab fa-github'></i>Github</a></li><li><a class=padding href=https://docs.velociraptor.app/discord/><i class='fab fa-discord'></i>Discord</a></li><li><a class=padding href=https://docs.velociraptor.app/youtube/><i class='fab fa-youtube'></i>YouTube</a></li><li><a class=padding href=mailto:velociraptor-discuss@googlegroups.com><i class='fas fa-envelope'></i>Mailing List</a></li><li><a class=padding href=https://docs.velociraptor.app/rss/><i class='fas fa-rss'></i>RSS</a></li><li><a class=padding href=https://docs.rapid7.com/insightidr/velociraptor-integration/><i class='fa fa-question-circle'></i>Rapid7 Docs</a></li></ul></section><section id=footer><div class=footer-copyright>Brought to you by
<img src=/images/Rapid7_logo.svg class=rapid7><br><i class="fas fa-copyright"></i> 2024</div></section></div></nav><script>$("#sidebar i.fa-angle-right").each(function(){$(this).parent().parent().find("ul").hide()})</script><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title='Edit this page' href=https://github.com/Velocidex/velociraptor-docs/edit/master/content/docs/gui/clients/_index.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>Inspecting clients</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#searching-for-a-client>Searching for a client</a></li><li><a href=#labels>Labels</a><ul><li><a href=#manipulating-labels-via-vql>Manipulating labels via VQL</a></li><li><a href=#built-in-labels>Built-in Labels</a></li></ul></li><li><a href=#selecting-a-client>Selecting a client</a><ul><li><a href=#vql-drilldown>VQL drilldown</a></li><li><a href=#table-gui-widgets>Table GUI Widgets</a></li><li><a href=#remote-shell-commands>Remote shell commands</a></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Inspecting clients</h1><p>Velociraptor clients are endpoints with the Velociraptor agent
running on them. Since Velociraptor maintains a persistent connection
to the server, each endpoint is immediately available to interact
with.</p><p>Typically we begin our investigation by searching for a client,
selecting it, and interactively collecting artifacts from it.</p><h2 id=searching-for-a-client>Searching for a client</h2><p>To work with a specific client, search for it using the
search bar at the top of the Admin GUI. Click the Search or Show All icon
to see all the clients.</p><p><figure id=10b186ceaf95d9dc5cbd5cccec415b65><div data-featherlight=#10b186ceaf95d9dc5cbd5cccec415b65 class=figure><img src=searching_client.png alt="Searching for a client"></div><figcaption><a class=image-link href=searching_client.png><i class="fa fa-download"></i></a>
Searching for a client</figcaption></figure></p><div class="mynotices tip"><div heading=tip><p>You can use the following prefixes as well:</p><ul><li><code>all</code>: show all clients</li><li><code>label:</code> to search clients with a label</li><li><code>host:</code> to search for hostnames.</li><li><code>ip</code>: to search based on IP address</li><li><code>mac</code>: to search based on MAC addresses</li><li><code>recent</code>: see all the recent clients this user interacted with.</li></ul><p>Clicking on the <code>online status</code> column header toggles the search
between all clients and only those that are currently online.</p></div></div><p>The search function uses a client index so can quickly
identify clients by hostname in the GUI. More complex search
requirements should be done in a notebook using full VQL syntax.</p><p>The results from the search are shown as a table.</p><p>The table contains five columns:</p><ol><li><p>The <strong>online state</strong> of the host is shown as a color icon. A green
dot indicated that the host is currently connected to the server, a
an exclamation icon indicates the host is not currently connected
but was connected between 15 minutes and 24 hours ago. A warning
triangle indicates that the host has not been seen for 24 hours or
more.</p></li><li><p>The <strong>client ID</strong> of the host is shown. Clients have a unique ID
starting with <code>C.</code>. Internally, the client ID is considered the
most accurate source of endpoint identity. Velociraptor always
refers to the client ID rather than the hostname because hostnames
can change. A client ID is derived from the client&rsquo;s cryptographic
key and is stored on the endpoint in the client <code>writeback file</code>. Clicking on the client id will take you to the host
information screen.</p></li><li><p>The <strong>hostname</strong> and <strong>Fully Qualified Domain Name</strong> reported by
the host.</p></li><li><p>The <strong>operating system version</strong>. This indicates if the host is a
Windows/Linux/MacOS machine and its respective version.</p></li><li><p>Any <strong>labels</strong> applied to the host. Clicking on a label removes the
label from this host.</p></li></ol><div class="mynotices tip"><div heading=tip><p>Once you view a particular host, the GUI will automatically remember it in a most recently used list (MRU). You can view your recent searches easily by selecting it from the gui.</p><p><figure id=931572f1fbd6834bbf0b3d738aac4921><div data-featherlight=#931572f1fbd6834bbf0b3d738aac4921 class=figure><img src=mru.png alt="Search page"></div><figcaption><a class=image-link href=mru.png><i class="fa fa-download"></i></a>
Search page</figcaption></figure></p></div></div><h2 id=labels>Labels</h2><p>Hosts may have labels attached to them. A label is any name associated
with a host. Labels are useful when we need to hunt for a well defined
group of hosts. We can restrict the hunt to one or more labels to
avoid collecting unnecessary data or accessing machines we should not
be.</p><p>It is possible to manipulate the labels via the search screen. Simply
select the hosts in the GUI and then click the &ldquo;add labels&rdquo; button.</p><p><figure id=f891c738c9683509097ace40bf73a96e><div data-featherlight=#f891c738c9683509097ace40bf73a96e class=figure><img src=labels.png alt="Adding labels"></div><figcaption><a class=image-link href=labels.png><i class="fa fa-download"></i></a>
Adding labels</figcaption></figure></p><h3 id=manipulating-labels-via-vql>Manipulating labels via VQL</h3><p>Although it is possible to manipulate labels via the GUI, It is
usually easier to use VQL queries to add or remove labels via the
<code>label()</code> plugin.</p><p>For example, let&rsquo;s say we wanted to label all machines with the local
user of <code>mike</code>. I would follow the following steps:</p><ol><li>Launch a hunt to list all user accounts on all endpoints using the
<code>Windows.Sys.Users</code>.</li><li>When enough results are returned, I click the <code>Notebook</code> tab in the
hunt manager to access the hunt&rsquo;s notebook.</li><li>Applying the query below I filter all results with the user <code>Mike</code>
and apply the label function to that host.</li></ol><p>Note that <code>HuntId</code> is automatically set to the hunt id inside the hunt notebook:</p><pre><code class=language-vql>SELECT Name, label(client_id=ClientId,
                   labels=&quot;Mikes Box&quot;,
                   op=&quot;set&quot;)
FROM hunt_results(hunt_id=HuntId,
                  artifact=&quot;Windows.Sys.Users&quot;)
WHERE Name =~ &quot;mike&quot;
</code></pre><div class="mynotices tip"><div heading=" Using labels to control hunts and monitoring "><p>Labels applied to clients essentially form groups. Many features in
Velociraptor apply to these groups and it is possible to move clients
in and out of these during the course of an investigation.</p><p>For example, client event monitoring queries are controlled via client
labels. This allows you to assign a detection rule to a group of
machines then simple add or remove machines from the group. Similarly
it is possible to restrict a hunt to a label group then simply add
clients to the label group in order to automatically add them to the
hunt.</p></div></div><h3 id=built-in-labels>Built-in Labels</h3><p>While one can add labels to machines using the GUI this is not
practical for labeling very large numbers of client, for example
belonging to a particular Active Directory Organizational Unit
(OU). It is reasonable to want to quickly select those machines
belonging to a particular OU.</p><p>We can use labels to identify machines installed by a specific group
policy. For example, suppose we have a particular OU called
<code>Sales</code>. We want to ensure that Velociraptor clients in the Sales team
are specifically marked by the <code>Sales</code> label.</p><p>Simply modify the client&rsquo;s configuration file to contain the Sales
label, and this label will be automatically applied when the client is
enrolled:</p><pre><code class=language-yaml>Client:
  labels:
  - Sales
</code></pre><p>Then we apply the Group Policy Object only on the Sales OU which will
result in those clients being enrolled with the Sales label
automatically.</p><h2 id=selecting-a-client>Selecting a client</h2><p>Click on any client in the search screen to view information relevant
to the selected client.</p><p>You can easily tell which client we are dealing with as the name of
the host, and the last time we connected with it are shown:</p><p><figure id=8b19d253715aebfecaf891936daef8a0><div data-featherlight=#8b19d253715aebfecaf891936daef8a0 class=figure><img src=client_overview.png alt="Host View"></div><figcaption><a class=image-link href=client_overview.png><i class="fa fa-download"></i></a>
Host View</figcaption></figure></p><p>Velociraptor maintains some basic information about the host, such as
its hostname, labels, last seen IP, and last seen time. This is shown
in the <code>Host View</code> pane. Velociraptor uses this information to make it
possible to search for this host and target it for further
investigation. Velociraptor gathers this information constantly from
the endpoint and upon first enrollment, so this information should be
relatively up to date. You can refresh this information at any time by
clicking the <code>Interrogate</code> button.</p><p>Each client has arbitrary metadata so you can integrate it easily into
your procedures. You can use this metadata to implement more complex
procedures using VQL artifacts.</p><p>Ultimately, interrogation simply collects the <code>Generic.Client.Info</code>
artifact from the endpoint. The <code>VQL Drilldown</code> page shows more
information about the client, including telemetry of the client&rsquo;s
footprint on the endpoint and more information about the endpoint.</p><div class="mynotices tip"><div heading=" Quarantining a host "><p>You can quarantine a host from this screen. Quarantining a host will
reconfigure the hosts&rsquo;s network stack to only allow it to communicate
with the Velociraptor server. This allows you to continue
investigating the host remotely while preventing the host from making
other network connections.</p><p>Quarantining is implemented using an event monitoring query which
means it persists across client reboots. A quarantined client will
gain the label <code>Quarantine</code> so you can easily search for all
quarantined hosts using the label search feature above.</p><p>Removing the quarantine label from a host will immediately
unquarantine the host. Read further how to automatically apply and
remove labels based on various events - this allows you to
automatically quarantine a host too!</p></div></div><h3 id=vql-drilldown>VQL drilldown</h3><p>Selecting the <code>VQL drilldown</code> screen will display an overview of
information about a host.</p><p><figure id=716919c2eefd93338766b74862a9cbaa><div data-featherlight=#716919c2eefd93338766b74862a9cbaa class=figure><img src=image58.png alt="VQL Drilldown"></div><figcaption><a class=image-link href=image58.png><i class="fa fa-download"></i></a>
VQL Drilldown</figcaption></figure></p><h3 id=table-gui-widgets>Table GUI Widgets</h3><p>A common UI element in the Velociraptor GUI is the table widget. Since
Velociraptor deals with VQL queries and all queries simply return a
list of rows, the GUI presents a lot of results in a table form.</p><p>All Velociraptor tables have some common tools available as can be
seen above:</p><ol><li><p>The Column Selector - allows users to show/hide columns. This is
useful when there are many columns and the table takes up a lot of
horizontal real estate, or when some columns provide too much
details</p></li><li><p>View Raw JSON - All VQL queries simply return a result set encoded
as a list of JSON objects. For more complex tables it is sometimes
easier to see the precise JSON returned, and clicking on this
button displays the raw json in a dialog box.</p></li></ol><p><figure id=28f966622d8a3076e24b66dbbefb2042><div data-featherlight=#28f966622d8a3076e24b66dbbefb2042 class=figure><img src=image59.png alt="Raw JSON"></div><figcaption><a class=image-link href=image59.png><i class="fa fa-download"></i></a>
Raw JSON</figcaption></figure></p><ol start=3><li>Export table as CSV or JSON - Clicking on the export table button
simply exports the <strong>visible</strong> columns as a CSV file. This is a
great way of filtering out uninteresting columns and producing more
targeted CSV files for post processing in e.g. Excel.</li></ol><h3 id=remote-shell-commands>Remote shell commands</h3><p>Usually Velociraptor encourages users to collect <code>Artifacts</code> which are
curated VQL queries. However, sometimes it is necessary to run
arbitrary commands on the endpoint in a dynamic incident response
operation.</p><p>The advantage of collecting artifacts is that they are generally better tested and controlled than just typing arbitrary Powershell or Bash commands in the GUI - remember, a single typo can ruin your day!</p><p>We recommend that arbitrary shell commands only be used as a last
resort and instead shell commands be run with the VQL <code>execve()</code>
plugin within the context of an artifact.</p><p>Velociraptor allows running arbitrary shell commands on the endpoint
using <code>Powershell</code>/<code>Cmd</code>/<code>Bash</code> or adhoc <code>VQL</code>.</p><p><figure id=195cfcb6080c3fcc04aba9996d3bc639><div data-featherlight=#195cfcb6080c3fcc04aba9996d3bc639 class=figure><img src=shell_commands.png alt="Shell command"></div><figcaption><a class=image-link href=shell_commands.png><i class="fa fa-download"></i></a>
Shell command</figcaption></figure></p><div class="mynotices note"><div heading=note><p>Only Velociraptor users with the administrator role are allowed to run
arbitrary shell commands on remote endpoints!</p></div></div><p>You can prevent clients from running arbitrary shell commands
by setting <code>Client.prevent_execve</code> to true. This limits your DFIR
efficacy because many artifacts depend on being able to launch
external programs.</p><footer class=footline></footer></div></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1728917965></script><script src=/js/perfect-scrollbar.min.js?1728917965></script><script src=/js/perfect-scrollbar.jquery.min.js?1728917965></script><script src=/js/jquery.sticky.js?1728917965></script><script src=/js/featherlight.min.js?1728917965></script><script src=/js/highlight.min.js?1728917965></script><script>hljs.highlightAll()</script><script src=/js/modernizr.custom-3.6.0.js?1728917965></script><script src=/js/learn.js?1728917965></script><script src=/js/hugo-learn.js?1728917965></script></body></html>